name: Fast Element benchmark jobs

on: [pull_request]

jobs:
    setup:
        name: Setup Tachometer Reporting
        runs-on: ubuntu-latest
        steps:
            - name: Initialize tachometer comment
              uses: andrewiggins/tachometer-reporter-action@v2
              with:
                  initialize: true
            - uses: actions/checkout@v2
            
            - uses: actions/setup-node@v2
              with:
                node-version: 16
                cache: 'npm'
       
            - name: Install package dependencies
              run: yarn install --frozen-lockfile --ignore-scripts --prefer-offline
            - name: Prepare workspaces
              run: yarn prepare

            #version test
            - name: Benchmark versions update10th
              run: |
                cd packages/utilities/fast-benchmarks
                yarn run benchmark:fast-element:test

            - name: Report update10th
              uses: andrewiggins/tachometer-reporter-action@v2
              with:
                report-id: update10th
                path: packages/utilities/fast-benchmarks/results/fast-element_test-update10th.json

            #local test 
            - name: Benchmark local create10k
              run: |
                cd packages/utilities/fast-benchmarks
                yarn run benchmark:fast-element:test:local

            - name: Report localTest-create10k
              uses: andrewiggins/tachometer-reporter-action@v2
              with:
                report-id: localTest-create10k
                path: packages/utilities/fast-benchmarks/results/fast-element_localTest-create10k.json
             
            # - uses: actions/upload-artifact@v3
            #   with:
            #       name: Upload results folder
            #       path: packages/utilities/fast-benchmarks/results/fast-element_test-update10th.json
            # - name: Report Tachometer Result
            #   uses: andrewiggins/tachometer-reporter-action@v2
            #   with:
            #       report-id: results
            #       path: packages/utilities/fast-benchmarks/results/fast-element_test-update10th.json

            # - uses: actions/upload-artifact@v3
            #   with:
            #       name: Upload results folder
            #       path: packages/utilities/fast-benchmarks/results/fast-element_localTest-create10k.json
            # - name: Report Tachometer Result
            #   uses: andrewiggins/tachometer-reporter-action@v2
            #   with:
            #       report-id: results-create-local
            #       path: packages/utilities/fast-benchmarks/results/fast-element_localTest-create10k.json